# –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è RoDaSoleil Shop

## ‚úÖ –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. Stripe –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

- [ ] –°–æ–∑–¥–∞–Ω Stripe –∞–∫–∫–∞—É–Ω—Ç
- [ ] –ü–æ–ª—É—á–µ–Ω—ã test –∫–ª—é—á–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- [ ] –ü–æ–ª—É—á–µ–Ω—ã live –∫–ª—é—á–∏ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- [ ] –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω Stripe –∞–∫–∫–∞—É–Ω—Ç
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã (–∫–∞—Ä—Ç—ã)

### 2. Telegram –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

- [ ] –°–æ–∑–¥–∞–Ω Telegram –±–æ—Ç —á–µ—Ä–µ–∑ @BotFather
- [ ] –ü–æ–ª—É—á–µ–Ω —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- [ ] –ü–æ–ª—É—á–µ–Ω Chat ID
- [ ] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É

### 3. Sanity CMS

- [ ] –°–æ–∑–¥–∞–Ω –ø—Ä–æ–µ–∫—Ç Sanity
- [ ] –ü–æ–ª—É—á–µ–Ω Project ID
- [ ] –ü–æ–ª—É—á–µ–Ω API —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å
- [ ] –ó–∞–≥—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–¥—É–∫—Ç—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `stripeProductId` –∏ `stripePriceId` –≤ —Å—Ö–µ–º—É –ø—Ä–æ–¥—É–∫—Ç–∞

### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ:

```env
# Sanity
NEXT_PUBLIC_SANITY_PROJECT_ID=your_project_id
NEXT_PUBLIC_SANITY_DATASET=production
SANITY_API_TOKEN=your_token_with_write_access

# Stripe
STRIPE_SECRET_KEY=sk_live_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id

# Site URL
NEXT_PUBLIC_BASE_URL=https://rodasoleil.bg
```

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –®–∞–≥ 1: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
npm run dev

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Å–æ Stripe
node scripts/sync-stripe.js
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –ª–æ–∫–∞–ª—å–Ω–æ
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É: `4242 4242 4242 4242`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
   - –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã

### –®–∞–≥ 3: –î–µ–ø–ª–æ–π –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥

#### –î–ª—è Vercel:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI
npm i -g vercel

# –î–µ–ø–ª–æ–π
vercel --prod

# –ò–ª–∏ —á–µ—Ä–µ–∑ GitHub
# 1. Push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
# 2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Vercel Dashboard
# 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Vercel Dashboard](https://vercel.com/dashboard)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. Settings ‚Üí Environment Variables
4. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env.local`

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Stripe Webhook –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Stripe Webhooks](https://dashboard.stripe.com/webhooks)
2. –ù–∞–∂–º–∏—Ç–µ **Add endpoint**
3. –í–≤–µ–¥–∏—Ç–µ URL: `https://rodasoleil.bg/api/webhooks/stripe`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è:
   - `checkout.session.completed`
   - `payment_intent.succeeded`
   - `payment_intent.payment_failed`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Signing secret** (whsec_...)
6. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel –∫–∞–∫ `STRIPE_WEBHOOK_SECRET`
7. –°–¥–µ–ª–∞–π—Ç–µ redeploy –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 5: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

```bash
curl -X POST https://rodasoleil.bg/api/sync-stripe \
  -H "Content-Type: application/json" \
  -d '{"syncAll": true}'
```

### –®–∞–≥ 6: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç: https://rodasoleil.bg
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ä–µ–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É** (—Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ live —Ä–µ–∂–∏–º–µ)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram –ø—Ä–∏—Ö–æ–¥–∏—Ç
   - –í Stripe Dashboard –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂
   - Webhook —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Stripe)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ Stripe:

- [Payments](https://dashboard.stripe.com/payments) - –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏
- [Webhooks](https://dashboard.stripe.com/webhooks) - –ª–æ–≥–∏ webhook
- [Events](https://dashboard.stripe.com/events) - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Stripe CLI
stripe listen --forward-to https://rodasoleil.bg/api/webhooks/stripe

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏–µ
stripe trigger checkout.session.completed
```

### Telegram:

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Chat ID

## üõ†Ô∏è –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥—É–∫—Ç–∞:

1. –ò–∑–º–µ–Ω–∏—Ç–µ —Ü–µ–Ω—É –≤ Sanity CMS
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:
   ```bash
   curl -X POST https://rodasoleil.bg/api/sync-stripe \
     -H "Content-Type: application/json" \
     -d '{"productId": "product-id"}'
   ```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞:

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–¥—É–∫—Ç –≤ Sanity CMS
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Stripe Dashboard ‚Üí Events
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ webhook
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webhook URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

## üìä –í–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

–°–ª–µ–¥–∏—Ç–µ –∑–∞:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤ (Stripe Dashboard)
- –û—à–∏–±–∫–∞–º–∏ webhook (Stripe Events)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram
- –û—Ç–º–µ–Ω—ë–Ω–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è webhook
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–¥–ø–∏—Å–∏ webhook (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test keys –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –•—Ä–∞–Ω–∏—Ç–µ API –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: [STRIPE_INTEGRATION.md](./STRIPE_INTEGRATION.md)
2. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: [QUICK_START_STRIPE.md](./QUICK_START_STRIPE.md)
3. Stripe –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://stripe.com/docs
4. Telegram Bot API: https://core.telegram.org/bots/api

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à –º–∞–≥–∞–∑–∏–Ω –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –æ–Ω–ª–∞–π–Ω!

---

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ Sanity –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã —Å–æ Stripe!
