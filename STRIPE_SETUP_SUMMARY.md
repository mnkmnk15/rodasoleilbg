# üéâ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Stripe –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `stripe` - —Å–µ—Ä–≤–µ—Ä–Ω—ã–π SDK –¥–ª—è Stripe
- `@stripe/stripe-js` - –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π SDK –¥–ª—è Stripe

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ Sanity —Å—Ö–µ–º–∞ –ø—Ä–æ–¥—É–∫—Ç–∞
–§–∞–π–ª: [sanity/schemaTypes/product.ts](./sanity/schemaTypes/product.ts)

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
- `stripeProductId` - ID –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ Stripe (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- `stripePriceId` - ID —Ü–µ–Ω—ã –≤ Stripe (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### 3. –°–æ–∑–¥–∞–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ Stripe
–§–∞–π–ª: [lib/stripe.ts](./lib/stripe.ts)

–§—É–Ω–∫—Ü–∏–∏:
- `stripe()` - –ø–æ–ª—É—á–µ–Ω–∏–µ Stripe –∫–ª–∏–µ–Ω—Ç–∞
- `syncProductToStripe()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ —Å Stripe
- `createCheckoutSession()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –æ–ø–ª–∞—Ç—ã
- `getCheckoutSession()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Å—Å–∏–∏
- `constructWebhookEvent()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ webhook –ø–æ–¥–ø–∏—Å–∏

### 4. –°–æ–∑–¥–∞–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
–§–∞–π–ª: [lib/telegram.ts](./lib/telegram.ts)

–§—É–Ω–∫—Ü–∏–∏:
- `sendTelegramNotification()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
- `formatOrderMessage()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–∫–∞–∑–µ

### 5. –°–æ–∑–¥–∞–Ω—ã API endpoints

#### POST /api/checkout
–§–∞–π–ª: [app/api/checkout/route.ts](./app/api/checkout/route.ts)
- –°–æ–∑–¥–∞–µ—Ç —Å–µ—Å—Å–∏—é –æ–ø–ª–∞—Ç—ã Stripe
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ Sanity
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ Stripe Checkout

#### POST /api/webhooks/stripe
–§–∞–π–ª: [app/api/webhooks/stripe/route.ts](./app/api/webhooks/stripe/route.ts)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç Stripe
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

#### POST /api/sync-stripe
–§–∞–π–ª: [app/api/sync-stripe/route.ts](./app/api/sync-stripe/route.ts)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ Sanity —Å–æ Stripe
- –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏ —Ü–µ–Ω—ã
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç ID –æ–±—Ä–∞—Ç–Ω–æ –≤ Sanity

### 6. –°–æ–∑–¥–∞–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞

#### /[locale]/checkout
–§–∞–π–ª: [app/[locale]/checkout/page.tsx](./app/[locale]/checkout/page.tsx)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–≤–æ–¥–∫—É –∑–∞–∫–∞–∑–∞
- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –æ–ø–ª–∞—Ç–µ
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Stripe Checkout

#### /[locale]/checkout/success
–§–∞–π–ª: [app/[locale]/checkout/success/page.tsx](./app/[locale]/checkout/success/page.tsx)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
- –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞

#### /[locale]/checkout/cancel
–§–∞–π–ª: [app/[locale]/checkout/cancel/page.tsx](./app/[locale]/checkout/cancel/page.tsx)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–º–µ–Ω–µ–Ω–Ω–æ–π –æ–ø–ª–∞—Ç—ã
- –í–æ–∑–≤—Ä–∞—Ç –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é
- –¢–æ–≤–∞—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫–æ—Ä–∑–∏–Ω–µ

### 7. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–≤–æ–¥—ã
–§–∞–π–ª—ã:
- [messages/bg.json](./messages/bg.json)
- [messages/ru.json](./messages/ru.json)
- [messages/en.json](./messages/en.json)

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è `checkout` —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏.

### 8. –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Ñ–∏–≥ Sanity
–§–∞–π–ª: [sanity/config.ts](./sanity/config.ts)

–î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∏–µ–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å:
- `sanityClientWithToken` - –¥–ª—è API routes

### 9. –û–±–Ω–æ–≤–ª–µ–Ω .env.example
–§–∞–π–ª: [.env.example](./.env.example)

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏.

### 10. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–§–∞–π–ª: [STRIPE_INTEGRATION.md](./STRIPE_INTEGRATION.md)
- –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

#### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–§–∞–π–ª: [QUICK_START_STRIPE.md](./QUICK_START_STRIPE.md)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è
–§–∞–π–ª: [DEPLOYMENT_CHECKLIST.md](./DEPLOYMENT_CHECKLIST.md)
- –ü–æ—à–∞–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### 11. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
–§–∞–π–ª: [scripts/sync-stripe.js](./scripts/sync-stripe.js)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```bash
node scripts/sync-stripe.js
```

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cp .env.example .env.local
   ```
   –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª—é—á–∏.

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä**
   ```bash
   npm run dev
   ```

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã**
   ```bash
   node scripts/sync-stripe.js
   ```

4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ!**
   - –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
   - –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É: `4242 4242 4242 4242`

### –î–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ production:

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ [DEPLOYMENT_CHECKLIST.md](./DEPLOYMENT_CHECKLIST.md)

## üîë –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª—é—á–∏

–í–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:

1. **Stripe**
   - Publishable key (pk_test_... –∏–ª–∏ pk_live_...)
   - Secret key (sk_test_... –∏–ª–∏ sk_live_...)
   - Webhook secret (whsec_...)

2. **Telegram**
   - Bot token (–æ—Ç @BotFather)
   - Chat ID (–≤–∞—à –ª–∏—á–Ω—ã–π Chat ID)

3. **Sanity**
   - Project ID
   - API Token (—Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å)

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Stripe
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
- ‚úÖ –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å (BG, RU, EN)
- ‚úÖ –°–±–æ—Ä –∞–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –∏ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ Webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [STRIPE_INTEGRATION.md](./STRIPE_INTEGRATION.md)
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: [QUICK_START_STRIPE.md](./QUICK_START_STRIPE.md)
- –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è: [DEPLOYMENT_CHECKLIST.md](./DEPLOYMENT_CHECKLIST.md)

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –∏ –ø—Ä–∏–µ–º—É –ø–ª–∞—Ç–µ–∂–µ–π. –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞.

**Build –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ‚úÖ**

---

*–°–æ–∑–¥–∞–Ω–æ –¥–ª—è RoDaSoleil Bulgaria Shop*
